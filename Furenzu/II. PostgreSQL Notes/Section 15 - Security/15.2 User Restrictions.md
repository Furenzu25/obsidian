# ğŸ›¡ï¸ PostgreSQL Security Basics â€“ Study Notes

## ğŸ‘‹ Introduction

Welcome to a new section focused on **PostgreSQL database security**. Security is **critical** in any system â€” not just as a one-time setup but as an **ongoing responsibility** for every database administrator.

> ğŸ’¡ Security should be **proactive**, not reactive.

---

## ğŸ” Why Database Security Matters

- Protects against **data theft** and **unauthorized access**.
    
- Frequently neglected by companies, leading to major breaches.
    
- DBAs must check:
    
    - ğŸ‘¤ Who can access what?
        
    - â³ For how long?
        
    - ğŸ›‘ What should be restricted?
        

---

## âœ‹ Temporarily Preventing User Login

Sometimes you want to prevent a user from logging in without deleting their account.

### âœ… How to do it:
	
	sql
	
`ALTER USER username NOLOGIN;`

- Example: `ALTER USER vitor NOLOGIN;`
    
- Use `\du` to verify: user should have `Cannot login` in their attributes.
    

> ğŸ›¡ï¸ Good for compromised accounts or temporary suspensions.

---

## ğŸ” Limiting Simultaneous Connections

You can also **restrict how many connections a user can make** at once.

### ğŸ”¢ Set connection limit:
	
	sql
	
`ALTER USER username CONNECTION LIMIT 10;`

- `0`: No connections allowed.
    
- `10`: Max of 10 simultaneous connections.
    
- `-1`: Unlimited connections (default).
    

> ğŸ“Œ Use to control resource usage or avoid abuse.

---

## âš¡ Immediately Disconnect Users

If you revoke login rights, the user may still stay connected until they disconnect or the DB restarts.

### ğŸ”¨ Disconnect them now:
	
	sql
	
`SELECT pg_terminate_backend(pid) FROM pg_stat_activity WHERE usename = 'username';`

- Instantly kicks them out without rebooting the DB.
    

---

## ğŸ§¹ Safely Deleting Users Without Losing Data

You **cannot** delete a user if they still **own any database objects**.

### âŒ Wrong:
	
	sql
	
`DROP ROLE vitor; -- âŒ Will fail if user owns objects`

### âœ… Right process:

1. **Transfer ownership** of all objects:
    
	
	sql
	
`REASSIGN OWNED BY vitor TO postgres;`

2. **Revoke all privileges**:
    
	
	sql
	
`DROP OWNED BY vitor;`

3. **Delete the user**:
    
	
	sql
	
`DROP USER vitor;`

- Use `\du` to confirm user removal.
    
- Run `\l` or `\dt` to confirm **no data was lost**.
    

> âœ… Ensures database objects (tables, schemas, etc.) remain intact.

---

## ğŸ“š What You Learned in This Lesson

- ğŸŒ How to manage user logins and access restrictions.
    
- ğŸ” Temporary vs. permanent login blocks.
    
- ğŸ”„ How to handle user cleanup securely.
    
- ğŸ‘¨â€ğŸ’» PostgreSQL commands and best practices for user management.
    
- âš ï¸ Why regular security reviews are essential.
    

---

## ğŸ“ Practice Task (Suggested)

- Try creating a new user.
    
- Assign them ownership of some test tables.
    
- Use the full `REASSIGN OWNED`, `DROP OWNED`, and `DROP USER` sequence to remove them while preserving the data.
    

---

## ğŸ™‹â€â™‚ï¸ Final Notes

- Stay alert. Constantly **monitor and update** security measures.
    
- More advanced lessons and tips will follow in this security section.
    
- If you're stuck, **ask questions in the course forum**.
    

> ğŸ¤— Thanks for attending this lesson. Stay safe and see you in the next class!