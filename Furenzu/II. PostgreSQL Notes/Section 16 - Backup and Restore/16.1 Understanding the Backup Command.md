# ğŸ“š Study Notes: PostgreSQL Backup & Restoration

## ğŸ” Introduction to Backup and Restore

In this session, we focused on learning **backup and restoration methods** in PostgreSQL â€” a vital skill for ensuring **data safety, recovery**, and system reliability.

---

## ğŸ› ï¸ Tools Used for Backup

### 1. **`pg_dump`**

- Used to **back up a single database**.
    
- Flexible options for:
    
    - ğŸ·ï¸ Database name
        
    - ğŸŒ Hostname / IP
        
    - ğŸ” Port and password
        
    - ğŸ“ File format (plain, custom, TAR)
        

**Command Example**:
	
	bash
	
	`pg_dump -h localhost -U postgres -W -F t my_dbadmin > my_dbadmin.tar`

---

### 2. **`pg_dumpall`**

- Used for **full server backup**, including:
    
    - ğŸ§‘â€ğŸ’» Roles and users
        
    - ğŸ—‚ï¸ All databases
        
    - ğŸ“Š Tables, schemas, extensions, and settings
        

**Use When**:

- Doing a **global or complete** backup.
    
- Need to save **user accounts and privileges**.
    

---

### 3. **`psql`**

- Used for **restoration** of the backed-up `.sql` or `.tar` files.
    
- We'll explore its usage in the **next class**.
    

---

## ğŸ§° Backup Scenarios & Commands

### âœ… Full Backup of a Specific Database
	
	bash
	
	`pg_dump -h localhost -U postgres -W -F t my_dbadmin > my_dbadmin.tar`

### âœ… Backup of a Specific Table
	
	bash
	
`pg_dump -h localhost -U postgres -W -F c -t pay_* my_dbadmin > my_pay_table.backup`

ğŸ” _Use pattern matching (e.g. `pay_*`) to include specific tables._

### âœ… Backup of All Schemas in Public
	
	bash
	
`pg_dump -h localhost -U postgres -W -n public my_dbadmin > public_schemas.backup`

---

## âš™ï¸ Backup File Formats (`-F` option)

|Format Option|Description|
|---|---|
|`p`|Plain SQL text format|
|`c`|Custom format|
|`t`|TAR archive|
|`d`|Directory format|

---

## ğŸ“¦ Backup Storage Best Practices

- ğŸ’¾ **Store backups offline** to prevent data loss during hardware failures.
    
- â˜ï¸ **Send to cloud servers** (if small enough) for remote recovery.
    
- ğŸ• **Schedule during off-peak hours** to avoid performance issues.
    
- ğŸ“‚ Use directories to organize backups for large databases.
    
- ğŸ§  Always **compress** large backups for efficiency (`gzip`, `.tar.gz`, etc.)
    

---

## ğŸ§ª Parallel Backups (Better Performance)

Use the `-j` option to run backups in parallel:
	
	bash
	
`pg_dump -j 3 -F d -f ./backup_dir my_dbadmin`

ğŸ”„ This increases performance for large databases by using **multiple jobs**.

---

## ğŸŒ Global Dump (Complete Server Backup)
	
	bash
	
`pg_dumpall -h localhost -U postgres -W > global_backup.sql`

- Includes all: users, databases, tablespaces, schemas, privileges, etc.
    
- ğŸŒ Recommended for full recovery planning.
    

---

## ğŸ§± Specific Component Backups

|Component|Example Command|
|---|---|
|Roles|`pg_dumpall -r > roles.sql`|
|Tablespaces|`pg_dumpall -t > tablespaces.sql`|
|Specific Table|`pg_dump -t table_name db_name > table.sql`|
|Global|`pg_dumpall > full_server_backup.sql`|

---

## ğŸ“Œ Key Reminders

- ğŸ›‘ Avoid backups during high-usage hours.
    
- âœ… Always test backup files before assuming they work.
    
- ğŸ”‘ Ensure users running backups have the correct permissions.
    
- ğŸ’¡ Use scripts for automation and regular backups.
    
- ğŸ§© Next steps: RESTORATION methods & full backup automation script.
    

---

## ğŸ Whatâ€™s Next?

In the next class, weâ€™ll:

- ğŸ”„ Learn **how to restore** backups
    
- ğŸ§¾ Write a **full backup script**
    
- ğŸ§  Deepen understanding of **PostgreSQL backup architecture**
    

ğŸ‘‹ _Until then, review these commands and test them in your environment._