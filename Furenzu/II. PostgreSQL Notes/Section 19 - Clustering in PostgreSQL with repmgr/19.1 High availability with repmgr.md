## ğŸ˜ PostgreSQL Cluster Setup â€“ Study Notes

### ğŸ‘‹ Introduction

Welcome! In this session, weâ€™ll be learning **how to create a PostgreSQL cluster** using multiple serversâ€”ideal for ensuring high availability and fault tolerance in a production environment.

---

### ğŸ§  Key Concepts

- **PostgreSQL is not limited to a single instance.**
    
- Weâ€™ll be using **4 servers** (virtual or physical):
    
    - ğŸŸ¢ 1 **Primary server**
        
    - ğŸ”µ 2 **Standby servers**
        
    - ğŸŸ¡ 1 **Witness server**
        

---

### ğŸ–¥ï¸ Machine Setup

You can use:

- ğŸ’» **VirtualBox** (recommended: clone machines to simplify IP and hostname configuration)
    
- â˜ï¸ **Cloud servers**
    
- ğŸ§ª Or any environment that supports Linux (Rocky Linux 9)
    

All 4 servers must:

- Use the **same OS** (e.g., Rocky Linux 9)
    
- Use the **same PostgreSQL version** (e.g., v15 or your preferred version)
    

---

### ğŸ” Replication â‰  Backup

**Important distinction:**

- Replication ensures real-time data synchronization between servers.
    
- It **does not replace backups**. Always maintain a proper backup strategy.
    

---

### ğŸ—ï¸ Cluster Components

1. **Primary Server (pg1)**
    
    - Handles all operations: INSERT, UPDATE, DELETE
        
    - All data changes are replicated to standby servers
        
2. **Standby Servers (pg2, pg3)**
    
    - Passive replicas of the primary
        
    - Automatically sync data in real time
        
3. **Witness Server (pg_witness)**
    
    - Not part of the replication itself
        
    - Acts as a decision-maker ğŸ§  during failover
        
    - Elects a new **primary** if the current one fails (based on configured priorities)
        

---

### ğŸ”§ Configuration & Tools

You'll be working with:

- ğŸ” **SSH**
    
- ğŸ“‚ **Linux configuration files**
    
- ğŸ§© Custom settings for replication and failover
    
- ğŸ“œ PostgreSQL configuration files
    

All steps will be provided with commands and files to follow ğŸ‘¨â€ğŸ’»ğŸ“‘

---

### ğŸ§­ Class Format & Requirements

- This is an **advanced-level class** ğŸ§ âš™ï¸
    
- Basic knowledge of:
    
    - Linux
        
    - Terminal commands
        
    - Networking (IP/hostname)
        
    - PostgreSQL setup
        

â¡ï¸ Youâ€™ll follow a **step-by-step** guide through the setup and configuration process.

---

### ğŸ”¢ Machine Naming Convention

|Server Role|Hostname|
|---|---|
|Primary|`pg1` ğŸŸ¢|
|Standby #1|`pg2` ğŸ”µ|
|Standby #2|`pg3` ğŸ”µ|
|Witness Server|`pg_witness` ğŸŸ¡|

---

### ğŸ§© Summary

- Weâ€™re creating a **PostgreSQL cluster** with 4 machines.
    
- Real-time replication will be configured between primary and standby nodes.
    
- A **witness server** ensures automatic failover if the primary goes down.
    
- All machines must be uniform in OS and PostgreSQL version.
    
- You'll need Linux and PostgreSQL knowledge to keep up.
    
- Don't worryâ€”**every command will be provided and explained step-by-step**.
    

---

### ğŸ™‹ Questions?

If you have any doubts or questions, feel free to ask them in the course community or support chat. We're here to help!