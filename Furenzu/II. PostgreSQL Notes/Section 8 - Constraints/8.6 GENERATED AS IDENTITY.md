## üß† Study Notes: `GENERATED AS IDENTITY` in PostgreSQL

### üìò Introduction

In this class, we learned about a newer way to automatically generate unique values for a column in PostgreSQL using `GENERATED AS IDENTITY`. This is a modern alternative to the older `SERIAL` data type, and it was introduced in **PostgreSQL version 10**.

---

### üèóÔ∏è Basic Syntax

When creating a table with an identity column, the syntax looks like:
	
	sql
	
`column_name data_type GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY`

- The column is typically of type `INTEGER` or `BIGINT`.
    
- You can use either `GENERATED ALWAYS AS IDENTITY` or `GENERATED BY DEFAULT AS IDENTITY`.
    

---

### üîç Difference Between `ALWAYS` and `BY DEFAULT`

|Option|Description|
|---|---|
|`GENERATED ALWAYS`|System **always** generates the value. You **cannot** insert or update this column manually. An error will occur if you try.|
|`GENERATED BY DEFAULT`|System generates the value **by default**, but you **can override** it by inserting your own value.|

---

### üÜö Comparison: `IDENTITY` vs `SEQUENCE`

- Both can auto-generate unique numbers.
    
- **Sequences** are independent objects that can be reused across tables.
    
- **IDENTITY** columns are **tied to a specific column** and **cannot** be used globally.
    
- Think of `IDENTITY` as being stricter and more table-bound.
    

---

### üß™ Practical Examples

#### üìã Example 1: Using `GENERATED ALWAYS`
	
	sql
	
`CREATE TABLE Colors (   color_id INT GENERATED ALWAYS AS IDENTITY,   color_name VARCHAR(50) );`

- When inserting a row:
    
	
		sql
	
`INSERT INTO Colors (color_name) VALUES ('Red');`

- The `color_id` is automatically set (e.g., 1).
    
- You **cannot** manually insert or update `color_id`. Trying will raise an error.
    

#### ‚úÖ Overriding Restriction (Override System Value)

If you **must** override this behavior:
	
	sql
	
`INSERT INTO Colors (color_id, color_name) OVERRIDING SYSTEM VALUE VALUES (10, 'Green');`

#### üìã Example 2: Using `BY DEFAULT` with Start and Increment
	
	sql
	
`CREATE TABLE Colors (   color_id INT GENERATED BY DEFAULT AS IDENTITY (START WITH 10 INCREMENT BY 10),   color_name VARCHAR(50) );`

- Inserts will auto-generate values: 10, 20, 30, etc.
    
- You can **still insert custom values** if needed.
    

---

### üîÑ Modifying Identity Columns

#### ‚úÖ Add Identity to an Existing Column
	
	sql
	
`ALTER TABLE Forms ALTER COLUMN form_id ADD GENERATED ALWAYS AS IDENTITY;`

- Column must be `NOT NULL`.
    

#### üîÅ Change From `ALWAYS` to `BY DEFAULT`
	
	sql
	
`ALTER TABLE Forms ALTER COLUMN form_id SET GENERATED BY DEFAULT;`

#### ‚ùå Remove Identity Restriction
	
	sql
	
`ALTER TABLE Forms ALTER COLUMN form_id DROP IDENTITY IF EXISTS;`

- This removes the identity restriction, but the column remains.
    

---

### üìù Summary

- `GENERATED AS IDENTITY` replaces the older `SERIAL` approach.
    
- It offers more control and better SQL standard compliance.
    
- Use `ALWAYS` for strict automatic IDs.
    
- Use `BY DEFAULT` if you want flexibility to insert values manually.
    
- Use `OVERRIDING SYSTEM VALUE` to bypass restrictions when needed.
    
- You can alter existing columns to add, modify, or drop identity settings.
    

---

### üìñ Final Tips

- Practice inserting data using both `ALWAYS` and `BY DEFAULT`.
    
- Test the use of `START WITH` and `INCREMENT BY` for customized sequences.
    
- Read PostgreSQL documentation for advanced identity column options.